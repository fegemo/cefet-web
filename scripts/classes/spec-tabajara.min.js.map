{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/specificity/specificity.js","scripts/classes/spec-tabajara.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"spec-tabajara.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var SPECIFICITY = (function() {\n\tvar calculate,\n\t\tcalculateSingle,\n\t\tcompare;\n\n\t// Calculate the specificity for a selector by dividing it into simple selectors and counting them\n\tcalculate = function(input) {\n\t\tvar selectors,\n\t\t\tselector,\n\t\t\ti,\n\t\t\tlen,\n\t\t\tresults = [];\n\n\t\t// Separate input by commas\n\t\tselectors = input.split(',');\n\n\t\tfor (i = 0, len = selectors.length; i < len; i += 1) {\n\t\t\tselector = selectors[i];\n\t\t\tif (selector.length > 0) {\n\t\t\t\tresults.push(calculateSingle(selector));\n\t\t\t}\n\t\t}\n\n\t\treturn results;\n\t};\n\n\t/**\n\t * Calculates the specificity of CSS selectors\n\t * http://www.w3.org/TR/css3-selectors/#specificity\n\t *\n\t * Returns an object with the following properties:\n\t *  - selector: the input\n\t *  - specificity: e.g. 0,1,0,0\n\t *  - parts: array with details about each part of the selector that counts towards the specificity\n\t *  - specificityArray: e.g. [0, 1, 0, 0]\n\t */\n\tcalculateSingle = function(input) {\n\t\tvar selector = input,\n\t\t\tfindMatch,\n\t\t\ttypeCount = {\n\t\t\t\t'a': 0,\n\t\t\t\t'b': 0,\n\t\t\t\t'c': 0\n\t\t\t},\n\t\t\tparts = [],\n\t\t\t// The following regular expressions assume that selectors matching the preceding regular expressions have been removed\n\t\t\tattributeRegex = /(\\[[^\\]]+\\])/g,\n\t\t\tidRegex = /(#[^\\s\\+>~\\.\\[:]+)/g,\n\t\t\tclassRegex = /(\\.[^\\s\\+>~\\.\\[:]+)/g,\n\t\t\tpseudoElementRegex = /(::[^\\s\\+>~\\.\\[:]+|:first-line|:first-letter|:before|:after)/gi,\n\t\t\t// A regex for pseudo classes with brackets - :nth-child(), :nth-last-child(), :nth-of-type(), :nth-last-type(), :lang()\n\t\t\tpseudoClassWithBracketsRegex = /(:[\\w-]+\\([^\\)]*\\))/gi,\n\t\t\t// A regex for other pseudo classes, which don't have brackets\n\t\t\tpseudoClassRegex = /(:[^\\s\\+>~\\.\\[:]+)/g,\n\t\t\telementRegex = /([^\\s\\+>~\\.\\[:]+)/g;\n\n\t\t// Find matches for a regular expression in a string and push their details to parts\n\t\t// Type is \"a\" for IDs, \"b\" for classes, attributes and pseudo-classes and \"c\" for elements and pseudo-elements\n\t\tfindMatch = function(regex, type) {\n\t\t\tvar matches, i, len, match, index, length;\n\t\t\tif (regex.test(selector)) {\n\t\t\t\tmatches = selector.match(regex);\n\t\t\t\tfor (i = 0, len = matches.length; i < len; i += 1) {\n\t\t\t\t\ttypeCount[type] += 1;\n\t\t\t\t\tmatch = matches[i];\n\t\t\t\t\tindex = selector.indexOf(match);\n\t\t\t\t\tlength = match.length;\n\t\t\t\t\tparts.push({\n\t\t\t\t\t\tselector: input.substr(index, length),\n\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\tindex: index,\n\t\t\t\t\t\tlength: length\n\t\t\t\t\t});\n\t\t\t\t\t// Replace this simple selector with whitespace so it won't be counted in further simple selectors\n\t\t\t\t\tselector = selector.replace(match, Array(length + 1).join(' '));\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Replace escaped characters with plain text, using the \"A\" character\n\t\t// https://www.w3.org/TR/CSS21/syndata.html#characters\n\t\t(function() {\n\t\t\tvar replaceWithPlainText = function(regex) {\n\t\t\t\t\tvar matches, i, len, match;\n\t\t\t\t\tif (regex.test(selector)) {\n\t\t\t\t\t\tmatches = selector.match(regex);\n\t\t\t\t\t\tfor (i = 0, len = matches.length; i < len; i += 1) {\n\t\t\t\t\t\t\tmatch = matches[i];\n\t\t\t\t\t\t\tselector = selector.replace(match, Array(match.length + 1).join('A'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Matches a backslash followed by six hexadecimal digits followed by an optional single whitespace character\n\t\t\t\tescapeHexadecimalRegex = /\\\\[0-9A-Fa-f]{6}\\s?/g,\n\t\t\t\t// Matches a backslash followed by fewer than six hexadecimal digits followed by a mandatory single whitespace character\n\t\t\t\tescapeHexadecimalRegex2 = /\\\\[0-9A-Fa-f]{1,5}\\s/g,\n\t\t\t\t// Matches a backslash followed by any character\n\t\t\t\tescapeSpecialCharacter = /\\\\./g;\n\n\t\t\treplaceWithPlainText(escapeHexadecimalRegex);\n\t\t\treplaceWithPlainText(escapeHexadecimalRegex2);\n\t\t\treplaceWithPlainText(escapeSpecialCharacter);\n\t\t}());\n\n\t\t// Remove the negation psuedo-class (:not) but leave its argument because specificity is calculated on its argument\n\t\t(function() {\n\t\t\tvar regex = /:not\\(([^\\)]*)\\)/g;\n\t\t\tif (regex.test(selector)) {\n\t\t\t\tselector = selector.replace(regex, '     $1 ');\n\t\t\t}\n\t\t}());\n\n\t\t// Remove anything after a left brace in case a user has pasted in a rule, not just a selector\n\t\t(function() {\n\t\t\tvar regex = /{[^]*/gm,\n\t\t\t\tmatches, i, len, match;\n\t\t\tif (regex.test(selector)) {\n\t\t\t\tmatches = selector.match(regex);\n\t\t\t\tfor (i = 0, len = matches.length; i < len; i += 1) {\n\t\t\t\t\tmatch = matches[i];\n\t\t\t\t\tselector = selector.replace(match, Array(match.length + 1).join(' '));\n\t\t\t\t}\n\t\t\t}\n\t\t}());\n\n\t\t// Add attribute selectors to parts collection (type b)\n\t\tfindMatch(attributeRegex, 'b');\n\n\t\t// Add ID selectors to parts collection (type a)\n\t\tfindMatch(idRegex, 'a');\n\n\t\t// Add class selectors to parts collection (type b)\n\t\tfindMatch(classRegex, 'b');\n\n\t\t// Add pseudo-element selectors to parts collection (type c)\n\t\tfindMatch(pseudoElementRegex, 'c');\n\n\t\t// Add pseudo-class selectors to parts collection (type b)\n\t\tfindMatch(pseudoClassWithBracketsRegex, 'b');\n\t\tfindMatch(pseudoClassRegex, 'b');\n\n\t\t// Remove universal selector and separator characters\n\t\tselector = selector.replace(/[\\*\\s\\+>~]/g, ' ');\n\n\t\t// Remove any stray dots or hashes which aren't attached to words\n\t\t// These may be present if the user is live-editing this selector\n\t\tselector = selector.replace(/[#\\.]/g, ' ');\n\n\t\t// The only things left should be element selectors (type c)\n\t\tfindMatch(elementRegex, 'c');\n\n\t\t// Order the parts in the order they appear in the original selector\n\t\t// This is neater for external apps to deal with\n\t\tparts.sort(function(a, b) {\n\t\t\treturn a.index - b.index;\n\t\t});\n\n\t\treturn {\n\t\t\tselector: input,\n\t\t\tspecificity: '0,' + typeCount.a.toString() + ',' + typeCount.b.toString() + ',' + typeCount.c.toString(),\n\t\t\tspecificityArray: [0, typeCount.a, typeCount.b, typeCount.c],\n\t\t\tparts: parts\n\t\t};\n\t};\n\n\t/**\n\t * Compares two CSS selectors for specificity\n\t * Alternatively you can replace one of the CSS selectors with a specificity array\n\t *\n\t *  - it returns -1 if a has a lower specificity than b\n\t *  - it returns 1 if a has a higher specificity than b\n\t *  - it returns 0 if a has the same specificity than b\n\t */\n\tcompare = function(a, b) {\n\t\tvar aSpecificity,\n\t\t\tbSpecificity,\n\t\t\ti;\n\n\t\tif (typeof a ==='string') {\n\t\t\tif (a.indexOf(',') !== -1) {\n\t\t\t\tthrow 'Invalid CSS selector';\n\t\t\t} else {\n\t\t\t\taSpecificity = calculateSingle(a)['specificityArray'];\n\t\t\t}\n\t\t} else if (Array.isArray(a)) {\n\t\t\tif (a.filter(function(e) { return (typeof e === 'number'); }).length !== 4) {\n\t\t\t\tthrow 'Invalid specificity array';\n\t\t\t} else {\n\t\t\t\taSpecificity = a;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow 'Invalid CSS selector or specificity array';\n\t\t}\n\n\t\tif (typeof b ==='string') {\n\t\t\tif (b.indexOf(',') !== -1) {\n\t\t\t\tthrow 'Invalid CSS selector';\n\t\t\t} else {\n\t\t\t\tbSpecificity = calculateSingle(b)['specificityArray'];\n\t\t\t}\n\t\t} else if (Array.isArray(b)) {\n\t\t\tif (b.filter(function(e) { return (typeof e === 'number'); }).length !== 4) {\n\t\t\t\tthrow 'Invalid specificity array';\n\t\t\t} else {\n\t\t\t\tbSpecificity = b;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow 'Invalid CSS selector or specificity array';\n\t\t}\n\n\t\tfor (i = 0; i < 4; i += 1) {\n\t\t\tif (aSpecificity[i] < bSpecificity[i]) {\n\t\t\t\treturn -1;\n\t\t\t} else if (aSpecificity[i] > bSpecificity[i]) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t};\n\n\treturn {\n\t\tcalculate: calculate,\n\t\tcompare: compare\n\t};\n}());\n\n// Export for Node JS\nif (typeof exports !== 'undefined') {\n\texports.calculate = SPECIFICITY.calculate;\n\texports.compare = SPECIFICITY.compare;\n}\n","var spec = require('specificity'),\n\n    SpecificatorTabajara = function(inputEl, outputAEl, outputBEl,\n      outputCEl, buttonEl) {\n      this.inputEl = inputEl;\n      this.outputAEl = outputAEl;\n      this.outputBEl = outputBEl;\n      this.outputCEl = outputCEl;\n      this.buttonEl = buttonEl;\n    };\n\n// attaches the event handlers\nSpecificatorTabajara.prototype.start = function() {\n  var specificator = this;\n  this.buttonEl.onclick = function() {\n    specificator.calculate();\n  };\n};\n\nSpecificatorTabajara.prototype.calculate = function() {\n  // gets the value from the input\n  var input = this.inputEl.value,\n      result = spec.calculate(input)[0],\n      specificity;\n\n  if (result && result.specificity) {\n    result = result.specificity.split(',');\n  } else {\n    result = [0, 0, 0, 0];\n  }\n\n  // sets the value of the 3 outputs\n  this.outputAEl.innerHTML = result[1];\n  this.outputBEl.innerHTML = result[2];\n  this.outputCEl.innerHTML = result[3];\n};\n\n\nvar options = {\n  input: 'spec-tabajara-input',\n  output: [\n    'spec-tabajara-output-a',\n    'spec-tabajara-output-b',\n    'spec-tabajara-output-c'],\n  button: 'spec-tabajara-button'\n  },\n  inputEl = document.getElementById(options.input);\n\nif (inputEl) {\n  new SpecificatorTabajara(\n    inputEl,\n    document.getElementById(options.output[0]),\n    document.getElementById(options.output[1]),\n    document.getElementById(options.output[2]),\n    document.getElementById(options.button)\n  ).start();\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvc3BlY2lmaWNpdHkvc3BlY2lmaWNpdHkuanMiLCJzY3JpcHRzL2NsYXNzZXMvc3BlYy10YWJhamFyYS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBTUEVDSUZJQ0lUWSA9IChmdW5jdGlvbigpIHtcblx0dmFyIGNhbGN1bGF0ZSxcblx0XHRjYWxjdWxhdGVTaW5nbGUsXG5cdFx0Y29tcGFyZTtcblxuXHQvLyBDYWxjdWxhdGUgdGhlIHNwZWNpZmljaXR5IGZvciBhIHNlbGVjdG9yIGJ5IGRpdmlkaW5nIGl0IGludG8gc2ltcGxlIHNlbGVjdG9ycyBhbmQgY291bnRpbmcgdGhlbVxuXHRjYWxjdWxhdGUgPSBmdW5jdGlvbihpbnB1dCkge1xuXHRcdHZhciBzZWxlY3RvcnMsXG5cdFx0XHRzZWxlY3Rvcixcblx0XHRcdGksXG5cdFx0XHRsZW4sXG5cdFx0XHRyZXN1bHRzID0gW107XG5cblx0XHQvLyBTZXBhcmF0ZSBpbnB1dCBieSBjb21tYXNcblx0XHRzZWxlY3RvcnMgPSBpbnB1dC5zcGxpdCgnLCcpO1xuXG5cdFx0Zm9yIChpID0gMCwgbGVuID0gc2VsZWN0b3JzLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG5cdFx0XHRzZWxlY3RvciA9IHNlbGVjdG9yc1tpXTtcblx0XHRcdGlmIChzZWxlY3Rvci5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdHJlc3VsdHMucHVzaChjYWxjdWxhdGVTaW5nbGUoc2VsZWN0b3IpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gcmVzdWx0cztcblx0fTtcblxuXHQvKipcblx0ICogQ2FsY3VsYXRlcyB0aGUgc3BlY2lmaWNpdHkgb2YgQ1NTIHNlbGVjdG9yc1xuXHQgKiBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXNlbGVjdG9ycy8jc3BlY2lmaWNpdHlcblx0ICpcblx0ICogUmV0dXJucyBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XG5cdCAqICAtIHNlbGVjdG9yOiB0aGUgaW5wdXRcblx0ICogIC0gc3BlY2lmaWNpdHk6IGUuZy4gMCwxLDAsMFxuXHQgKiAgLSBwYXJ0czogYXJyYXkgd2l0aCBkZXRhaWxzIGFib3V0IGVhY2ggcGFydCBvZiB0aGUgc2VsZWN0b3IgdGhhdCBjb3VudHMgdG93YXJkcyB0aGUgc3BlY2lmaWNpdHlcblx0ICogIC0gc3BlY2lmaWNpdHlBcnJheTogZS5nLiBbMCwgMSwgMCwgMF1cblx0ICovXG5cdGNhbGN1bGF0ZVNpbmdsZSA9IGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0dmFyIHNlbGVjdG9yID0gaW5wdXQsXG5cdFx0XHRmaW5kTWF0Y2gsXG5cdFx0XHR0eXBlQ291bnQgPSB7XG5cdFx0XHRcdCdhJzogMCxcblx0XHRcdFx0J2InOiAwLFxuXHRcdFx0XHQnYyc6IDBcblx0XHRcdH0sXG5cdFx0XHRwYXJ0cyA9IFtdLFxuXHRcdFx0Ly8gVGhlIGZvbGxvd2luZyByZWd1bGFyIGV4cHJlc3Npb25zIGFzc3VtZSB0aGF0IHNlbGVjdG9ycyBtYXRjaGluZyB0aGUgcHJlY2VkaW5nIHJlZ3VsYXIgZXhwcmVzc2lvbnMgaGF2ZSBiZWVuIHJlbW92ZWRcblx0XHRcdGF0dHJpYnV0ZVJlZ2V4ID0gLyhcXFtbXlxcXV0rXFxdKS9nLFxuXHRcdFx0aWRSZWdleCA9IC8oI1teXFxzXFwrPn5cXC5cXFs6XSspL2csXG5cdFx0XHRjbGFzc1JlZ2V4ID0gLyhcXC5bXlxcc1xcKz5+XFwuXFxbOl0rKS9nLFxuXHRcdFx0cHNldWRvRWxlbWVudFJlZ2V4ID0gLyg6OlteXFxzXFwrPn5cXC5cXFs6XSt8OmZpcnN0LWxpbmV8OmZpcnN0LWxldHRlcnw6YmVmb3JlfDphZnRlcikvZ2ksXG5cdFx0XHQvLyBBIHJlZ2V4IGZvciBwc2V1ZG8gY2xhc3NlcyB3aXRoIGJyYWNrZXRzIC0gOm50aC1jaGlsZCgpLCA6bnRoLWxhc3QtY2hpbGQoKSwgOm50aC1vZi10eXBlKCksIDpudGgtbGFzdC10eXBlKCksIDpsYW5nKClcblx0XHRcdHBzZXVkb0NsYXNzV2l0aEJyYWNrZXRzUmVnZXggPSAvKDpbXFx3LV0rXFwoW15cXCldKlxcKSkvZ2ksXG5cdFx0XHQvLyBBIHJlZ2V4IGZvciBvdGhlciBwc2V1ZG8gY2xhc3Nlcywgd2hpY2ggZG9uJ3QgaGF2ZSBicmFja2V0c1xuXHRcdFx0cHNldWRvQ2xhc3NSZWdleCA9IC8oOlteXFxzXFwrPn5cXC5cXFs6XSspL2csXG5cdFx0XHRlbGVtZW50UmVnZXggPSAvKFteXFxzXFwrPn5cXC5cXFs6XSspL2c7XG5cblx0XHQvLyBGaW5kIG1hdGNoZXMgZm9yIGEgcmVndWxhciBleHByZXNzaW9uIGluIGEgc3RyaW5nIGFuZCBwdXNoIHRoZWlyIGRldGFpbHMgdG8gcGFydHNcblx0XHQvLyBUeXBlIGlzIFwiYVwiIGZvciBJRHMsIFwiYlwiIGZvciBjbGFzc2VzLCBhdHRyaWJ1dGVzIGFuZCBwc2V1ZG8tY2xhc3NlcyBhbmQgXCJjXCIgZm9yIGVsZW1lbnRzIGFuZCBwc2V1ZG8tZWxlbWVudHNcblx0XHRmaW5kTWF0Y2ggPSBmdW5jdGlvbihyZWdleCwgdHlwZSkge1xuXHRcdFx0dmFyIG1hdGNoZXMsIGksIGxlbiwgbWF0Y2gsIGluZGV4LCBsZW5ndGg7XG5cdFx0XHRpZiAocmVnZXgudGVzdChzZWxlY3RvcikpIHtcblx0XHRcdFx0bWF0Y2hlcyA9IHNlbGVjdG9yLm1hdGNoKHJlZ2V4KTtcblx0XHRcdFx0Zm9yIChpID0gMCwgbGVuID0gbWF0Y2hlcy5sZW5ndGg7IGkgPCBsZW47IGkgKz0gMSkge1xuXHRcdFx0XHRcdHR5cGVDb3VudFt0eXBlXSArPSAxO1xuXHRcdFx0XHRcdG1hdGNoID0gbWF0Y2hlc1tpXTtcblx0XHRcdFx0XHRpbmRleCA9IHNlbGVjdG9yLmluZGV4T2YobWF0Y2gpO1xuXHRcdFx0XHRcdGxlbmd0aCA9IG1hdGNoLmxlbmd0aDtcblx0XHRcdFx0XHRwYXJ0cy5wdXNoKHtcblx0XHRcdFx0XHRcdHNlbGVjdG9yOiBpbnB1dC5zdWJzdHIoaW5kZXgsIGxlbmd0aCksXG5cdFx0XHRcdFx0XHR0eXBlOiB0eXBlLFxuXHRcdFx0XHRcdFx0aW5kZXg6IGluZGV4LFxuXHRcdFx0XHRcdFx0bGVuZ3RoOiBsZW5ndGhcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHQvLyBSZXBsYWNlIHRoaXMgc2ltcGxlIHNlbGVjdG9yIHdpdGggd2hpdGVzcGFjZSBzbyBpdCB3b24ndCBiZSBjb3VudGVkIGluIGZ1cnRoZXIgc2ltcGxlIHNlbGVjdG9yc1xuXHRcdFx0XHRcdHNlbGVjdG9yID0gc2VsZWN0b3IucmVwbGFjZShtYXRjaCwgQXJyYXkobGVuZ3RoICsgMSkuam9pbignICcpKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvLyBSZXBsYWNlIGVzY2FwZWQgY2hhcmFjdGVycyB3aXRoIHBsYWluIHRleHQsIHVzaW5nIHRoZSBcIkFcIiBjaGFyYWN0ZXJcblx0XHQvLyBodHRwczovL3d3dy53My5vcmcvVFIvQ1NTMjEvc3luZGF0YS5odG1sI2NoYXJhY3RlcnNcblx0XHQoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcmVwbGFjZVdpdGhQbGFpblRleHQgPSBmdW5jdGlvbihyZWdleCkge1xuXHRcdFx0XHRcdHZhciBtYXRjaGVzLCBpLCBsZW4sIG1hdGNoO1xuXHRcdFx0XHRcdGlmIChyZWdleC50ZXN0KHNlbGVjdG9yKSkge1xuXHRcdFx0XHRcdFx0bWF0Y2hlcyA9IHNlbGVjdG9yLm1hdGNoKHJlZ2V4KTtcblx0XHRcdFx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IG1hdGNoZXMubGVuZ3RoOyBpIDwgbGVuOyBpICs9IDEpIHtcblx0XHRcdFx0XHRcdFx0bWF0Y2ggPSBtYXRjaGVzW2ldO1xuXHRcdFx0XHRcdFx0XHRzZWxlY3RvciA9IHNlbGVjdG9yLnJlcGxhY2UobWF0Y2gsIEFycmF5KG1hdGNoLmxlbmd0aCArIDEpLmpvaW4oJ0EnKSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LFxuXHRcdFx0XHQvLyBNYXRjaGVzIGEgYmFja3NsYXNoIGZvbGxvd2VkIGJ5IHNpeCBoZXhhZGVjaW1hbCBkaWdpdHMgZm9sbG93ZWQgYnkgYW4gb3B0aW9uYWwgc2luZ2xlIHdoaXRlc3BhY2UgY2hhcmFjdGVyXG5cdFx0XHRcdGVzY2FwZUhleGFkZWNpbWFsUmVnZXggPSAvXFxcXFswLTlBLUZhLWZdezZ9XFxzPy9nLFxuXHRcdFx0XHQvLyBNYXRjaGVzIGEgYmFja3NsYXNoIGZvbGxvd2VkIGJ5IGZld2VyIHRoYW4gc2l4IGhleGFkZWNpbWFsIGRpZ2l0cyBmb2xsb3dlZCBieSBhIG1hbmRhdG9yeSBzaW5nbGUgd2hpdGVzcGFjZSBjaGFyYWN0ZXJcblx0XHRcdFx0ZXNjYXBlSGV4YWRlY2ltYWxSZWdleDIgPSAvXFxcXFswLTlBLUZhLWZdezEsNX1cXHMvZyxcblx0XHRcdFx0Ly8gTWF0Y2hlcyBhIGJhY2tzbGFzaCBmb2xsb3dlZCBieSBhbnkgY2hhcmFjdGVyXG5cdFx0XHRcdGVzY2FwZVNwZWNpYWxDaGFyYWN0ZXIgPSAvXFxcXC4vZztcblxuXHRcdFx0cmVwbGFjZVdpdGhQbGFpblRleHQoZXNjYXBlSGV4YWRlY2ltYWxSZWdleCk7XG5cdFx0XHRyZXBsYWNlV2l0aFBsYWluVGV4dChlc2NhcGVIZXhhZGVjaW1hbFJlZ2V4Mik7XG5cdFx0XHRyZXBsYWNlV2l0aFBsYWluVGV4dChlc2NhcGVTcGVjaWFsQ2hhcmFjdGVyKTtcblx0XHR9KCkpO1xuXG5cdFx0Ly8gUmVtb3ZlIHRoZSBuZWdhdGlvbiBwc3VlZG8tY2xhc3MgKDpub3QpIGJ1dCBsZWF2ZSBpdHMgYXJndW1lbnQgYmVjYXVzZSBzcGVjaWZpY2l0eSBpcyBjYWxjdWxhdGVkIG9uIGl0cyBhcmd1bWVudFxuXHRcdChmdW5jdGlvbigpIHtcblx0XHRcdHZhciByZWdleCA9IC86bm90XFwoKFteXFwpXSopXFwpL2c7XG5cdFx0XHRpZiAocmVnZXgudGVzdChzZWxlY3RvcikpIHtcblx0XHRcdFx0c2VsZWN0b3IgPSBzZWxlY3Rvci5yZXBsYWNlKHJlZ2V4LCAnICAgICAkMSAnKTtcblx0XHRcdH1cblx0XHR9KCkpO1xuXG5cdFx0Ly8gUmVtb3ZlIGFueXRoaW5nIGFmdGVyIGEgbGVmdCBicmFjZSBpbiBjYXNlIGEgdXNlciBoYXMgcGFzdGVkIGluIGEgcnVsZSwgbm90IGp1c3QgYSBzZWxlY3RvclxuXHRcdChmdW5jdGlvbigpIHtcblx0XHRcdHZhciByZWdleCA9IC97W15dKi9nbSxcblx0XHRcdFx0bWF0Y2hlcywgaSwgbGVuLCBtYXRjaDtcblx0XHRcdGlmIChyZWdleC50ZXN0KHNlbGVjdG9yKSkge1xuXHRcdFx0XHRtYXRjaGVzID0gc2VsZWN0b3IubWF0Y2gocmVnZXgpO1xuXHRcdFx0XHRmb3IgKGkgPSAwLCBsZW4gPSBtYXRjaGVzLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG5cdFx0XHRcdFx0bWF0Y2ggPSBtYXRjaGVzW2ldO1xuXHRcdFx0XHRcdHNlbGVjdG9yID0gc2VsZWN0b3IucmVwbGFjZShtYXRjaCwgQXJyYXkobWF0Y2gubGVuZ3RoICsgMSkuam9pbignICcpKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0oKSk7XG5cblx0XHQvLyBBZGQgYXR0cmlidXRlIHNlbGVjdG9ycyB0byBwYXJ0cyBjb2xsZWN0aW9uICh0eXBlIGIpXG5cdFx0ZmluZE1hdGNoKGF0dHJpYnV0ZVJlZ2V4LCAnYicpO1xuXG5cdFx0Ly8gQWRkIElEIHNlbGVjdG9ycyB0byBwYXJ0cyBjb2xsZWN0aW9uICh0eXBlIGEpXG5cdFx0ZmluZE1hdGNoKGlkUmVnZXgsICdhJyk7XG5cblx0XHQvLyBBZGQgY2xhc3Mgc2VsZWN0b3JzIHRvIHBhcnRzIGNvbGxlY3Rpb24gKHR5cGUgYilcblx0XHRmaW5kTWF0Y2goY2xhc3NSZWdleCwgJ2InKTtcblxuXHRcdC8vIEFkZCBwc2V1ZG8tZWxlbWVudCBzZWxlY3RvcnMgdG8gcGFydHMgY29sbGVjdGlvbiAodHlwZSBjKVxuXHRcdGZpbmRNYXRjaChwc2V1ZG9FbGVtZW50UmVnZXgsICdjJyk7XG5cblx0XHQvLyBBZGQgcHNldWRvLWNsYXNzIHNlbGVjdG9ycyB0byBwYXJ0cyBjb2xsZWN0aW9uICh0eXBlIGIpXG5cdFx0ZmluZE1hdGNoKHBzZXVkb0NsYXNzV2l0aEJyYWNrZXRzUmVnZXgsICdiJyk7XG5cdFx0ZmluZE1hdGNoKHBzZXVkb0NsYXNzUmVnZXgsICdiJyk7XG5cblx0XHQvLyBSZW1vdmUgdW5pdmVyc2FsIHNlbGVjdG9yIGFuZCBzZXBhcmF0b3IgY2hhcmFjdGVyc1xuXHRcdHNlbGVjdG9yID0gc2VsZWN0b3IucmVwbGFjZSgvW1xcKlxcc1xcKz5+XS9nLCAnICcpO1xuXG5cdFx0Ly8gUmVtb3ZlIGFueSBzdHJheSBkb3RzIG9yIGhhc2hlcyB3aGljaCBhcmVuJ3QgYXR0YWNoZWQgdG8gd29yZHNcblx0XHQvLyBUaGVzZSBtYXkgYmUgcHJlc2VudCBpZiB0aGUgdXNlciBpcyBsaXZlLWVkaXRpbmcgdGhpcyBzZWxlY3RvclxuXHRcdHNlbGVjdG9yID0gc2VsZWN0b3IucmVwbGFjZSgvWyNcXC5dL2csICcgJyk7XG5cblx0XHQvLyBUaGUgb25seSB0aGluZ3MgbGVmdCBzaG91bGQgYmUgZWxlbWVudCBzZWxlY3RvcnMgKHR5cGUgYylcblx0XHRmaW5kTWF0Y2goZWxlbWVudFJlZ2V4LCAnYycpO1xuXG5cdFx0Ly8gT3JkZXIgdGhlIHBhcnRzIGluIHRoZSBvcmRlciB0aGV5IGFwcGVhciBpbiB0aGUgb3JpZ2luYWwgc2VsZWN0b3Jcblx0XHQvLyBUaGlzIGlzIG5lYXRlciBmb3IgZXh0ZXJuYWwgYXBwcyB0byBkZWFsIHdpdGhcblx0XHRwYXJ0cy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdHJldHVybiBhLmluZGV4IC0gYi5pbmRleDtcblx0XHR9KTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHRzZWxlY3RvcjogaW5wdXQsXG5cdFx0XHRzcGVjaWZpY2l0eTogJzAsJyArIHR5cGVDb3VudC5hLnRvU3RyaW5nKCkgKyAnLCcgKyB0eXBlQ291bnQuYi50b1N0cmluZygpICsgJywnICsgdHlwZUNvdW50LmMudG9TdHJpbmcoKSxcblx0XHRcdHNwZWNpZmljaXR5QXJyYXk6IFswLCB0eXBlQ291bnQuYSwgdHlwZUNvdW50LmIsIHR5cGVDb3VudC5jXSxcblx0XHRcdHBhcnRzOiBwYXJ0c1xuXHRcdH07XG5cdH07XG5cblx0LyoqXG5cdCAqIENvbXBhcmVzIHR3byBDU1Mgc2VsZWN0b3JzIGZvciBzcGVjaWZpY2l0eVxuXHQgKiBBbHRlcm5hdGl2ZWx5IHlvdSBjYW4gcmVwbGFjZSBvbmUgb2YgdGhlIENTUyBzZWxlY3RvcnMgd2l0aCBhIHNwZWNpZmljaXR5IGFycmF5XG5cdCAqXG5cdCAqICAtIGl0IHJldHVybnMgLTEgaWYgYSBoYXMgYSBsb3dlciBzcGVjaWZpY2l0eSB0aGFuIGJcblx0ICogIC0gaXQgcmV0dXJucyAxIGlmIGEgaGFzIGEgaGlnaGVyIHNwZWNpZmljaXR5IHRoYW4gYlxuXHQgKiAgLSBpdCByZXR1cm5zIDAgaWYgYSBoYXMgdGhlIHNhbWUgc3BlY2lmaWNpdHkgdGhhbiBiXG5cdCAqL1xuXHRjb21wYXJlID0gZnVuY3Rpb24oYSwgYikge1xuXHRcdHZhciBhU3BlY2lmaWNpdHksXG5cdFx0XHRiU3BlY2lmaWNpdHksXG5cdFx0XHRpO1xuXG5cdFx0aWYgKHR5cGVvZiBhID09PSdzdHJpbmcnKSB7XG5cdFx0XHRpZiAoYS5pbmRleE9mKCcsJykgIT09IC0xKSB7XG5cdFx0XHRcdHRocm93ICdJbnZhbGlkIENTUyBzZWxlY3Rvcic7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRhU3BlY2lmaWNpdHkgPSBjYWxjdWxhdGVTaW5nbGUoYSlbJ3NwZWNpZmljaXR5QXJyYXknXTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoYSkpIHtcblx0XHRcdGlmIChhLmZpbHRlcihmdW5jdGlvbihlKSB7IHJldHVybiAodHlwZW9mIGUgPT09ICdudW1iZXInKTsgfSkubGVuZ3RoICE9PSA0KSB7XG5cdFx0XHRcdHRocm93ICdJbnZhbGlkIHNwZWNpZmljaXR5IGFycmF5Jztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGFTcGVjaWZpY2l0eSA9IGE7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93ICdJbnZhbGlkIENTUyBzZWxlY3RvciBvciBzcGVjaWZpY2l0eSBhcnJheSc7XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVvZiBiID09PSdzdHJpbmcnKSB7XG5cdFx0XHRpZiAoYi5pbmRleE9mKCcsJykgIT09IC0xKSB7XG5cdFx0XHRcdHRocm93ICdJbnZhbGlkIENTUyBzZWxlY3Rvcic7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRiU3BlY2lmaWNpdHkgPSBjYWxjdWxhdGVTaW5nbGUoYilbJ3NwZWNpZmljaXR5QXJyYXknXTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoYikpIHtcblx0XHRcdGlmIChiLmZpbHRlcihmdW5jdGlvbihlKSB7IHJldHVybiAodHlwZW9mIGUgPT09ICdudW1iZXInKTsgfSkubGVuZ3RoICE9PSA0KSB7XG5cdFx0XHRcdHRocm93ICdJbnZhbGlkIHNwZWNpZmljaXR5IGFycmF5Jztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGJTcGVjaWZpY2l0eSA9IGI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93ICdJbnZhbGlkIENTUyBzZWxlY3RvciBvciBzcGVjaWZpY2l0eSBhcnJheSc7XG5cdFx0fVxuXG5cdFx0Zm9yIChpID0gMDsgaSA8IDQ7IGkgKz0gMSkge1xuXHRcdFx0aWYgKGFTcGVjaWZpY2l0eVtpXSA8IGJTcGVjaWZpY2l0eVtpXSkge1xuXHRcdFx0XHRyZXR1cm4gLTE7XG5cdFx0XHR9IGVsc2UgaWYgKGFTcGVjaWZpY2l0eVtpXSA+IGJTcGVjaWZpY2l0eVtpXSkge1xuXHRcdFx0XHRyZXR1cm4gMTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gMDtcblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdGNhbGN1bGF0ZTogY2FsY3VsYXRlLFxuXHRcdGNvbXBhcmU6IGNvbXBhcmVcblx0fTtcbn0oKSk7XG5cbi8vIEV4cG9ydCBmb3IgTm9kZSBKU1xuaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuXHRleHBvcnRzLmNhbGN1bGF0ZSA9IFNQRUNJRklDSVRZLmNhbGN1bGF0ZTtcblx0ZXhwb3J0cy5jb21wYXJlID0gU1BFQ0lGSUNJVFkuY29tcGFyZTtcbn1cbiIsInZhciBzcGVjID0gcmVxdWlyZSgnc3BlY2lmaWNpdHknKSxcblxuICAgIFNwZWNpZmljYXRvclRhYmFqYXJhID0gZnVuY3Rpb24oaW5wdXRFbCwgb3V0cHV0QUVsLCBvdXRwdXRCRWwsXG4gICAgICBvdXRwdXRDRWwsIGJ1dHRvbkVsKSB7XG4gICAgICB0aGlzLmlucHV0RWwgPSBpbnB1dEVsO1xuICAgICAgdGhpcy5vdXRwdXRBRWwgPSBvdXRwdXRBRWw7XG4gICAgICB0aGlzLm91dHB1dEJFbCA9IG91dHB1dEJFbDtcbiAgICAgIHRoaXMub3V0cHV0Q0VsID0gb3V0cHV0Q0VsO1xuICAgICAgdGhpcy5idXR0b25FbCA9IGJ1dHRvbkVsO1xuICAgIH07XG5cbi8vIGF0dGFjaGVzIHRoZSBldmVudCBoYW5kbGVyc1xuU3BlY2lmaWNhdG9yVGFiYWphcmEucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzcGVjaWZpY2F0b3IgPSB0aGlzO1xuICB0aGlzLmJ1dHRvbkVsLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICBzcGVjaWZpY2F0b3IuY2FsY3VsYXRlKCk7XG4gIH07XG59O1xuXG5TcGVjaWZpY2F0b3JUYWJhamFyYS5wcm90b3R5cGUuY2FsY3VsYXRlID0gZnVuY3Rpb24oKSB7XG4gIC8vIGdldHMgdGhlIHZhbHVlIGZyb20gdGhlIGlucHV0XG4gIHZhciBpbnB1dCA9IHRoaXMuaW5wdXRFbC52YWx1ZSxcbiAgICAgIHJlc3VsdCA9IHNwZWMuY2FsY3VsYXRlKGlucHV0KVswXSxcbiAgICAgIHNwZWNpZmljaXR5O1xuXG4gIGlmIChyZXN1bHQgJiYgcmVzdWx0LnNwZWNpZmljaXR5KSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNwZWNpZmljaXR5LnNwbGl0KCcsJyk7XG4gIH0gZWxzZSB7XG4gICAgcmVzdWx0ID0gWzAsIDAsIDAsIDBdO1xuICB9XG5cbiAgLy8gc2V0cyB0aGUgdmFsdWUgb2YgdGhlIDMgb3V0cHV0c1xuICB0aGlzLm91dHB1dEFFbC5pbm5lckhUTUwgPSByZXN1bHRbMV07XG4gIHRoaXMub3V0cHV0QkVsLmlubmVySFRNTCA9IHJlc3VsdFsyXTtcbiAgdGhpcy5vdXRwdXRDRWwuaW5uZXJIVE1MID0gcmVzdWx0WzNdO1xufTtcblxuXG52YXIgb3B0aW9ucyA9IHtcbiAgaW5wdXQ6ICdzcGVjLXRhYmFqYXJhLWlucHV0JyxcbiAgb3V0cHV0OiBbXG4gICAgJ3NwZWMtdGFiYWphcmEtb3V0cHV0LWEnLFxuICAgICdzcGVjLXRhYmFqYXJhLW91dHB1dC1iJyxcbiAgICAnc3BlYy10YWJhamFyYS1vdXRwdXQtYyddLFxuICBidXR0b246ICdzcGVjLXRhYmFqYXJhLWJ1dHRvbidcbiAgfSxcbiAgaW5wdXRFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdGlvbnMuaW5wdXQpO1xuXG5pZiAoaW5wdXRFbCkge1xuICBuZXcgU3BlY2lmaWNhdG9yVGFiYWphcmEoXG4gICAgaW5wdXRFbCxcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvcHRpb25zLm91dHB1dFswXSksXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3B0aW9ucy5vdXRwdXRbMV0pLFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9wdGlvbnMub3V0cHV0WzJdKSxcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvcHRpb25zLmJ1dHRvbilcbiAgKS5zdGFydCgpO1xufVxuIl19"}